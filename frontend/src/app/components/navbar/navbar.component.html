<nav class="bg-gray-900 text-white flex items-center justify-between px-6 py-4 shadow-lg">
  <div class="flex items-center">
    <a routerLink="/" class="text-2xl font-bold hover:text-primary">E-Shop</a>
    <ul class="hidden md:flex ml-8 space-x-6">
      <ng-container *ngFor="let cat of categories">
        <li class="relative group">
          <a [routerLink]="['/products']" [queryParams]="{ category: cat._id }" class="hover:text-primary cursor-pointer">
            {{ cat.name }}
          </a>
          <ng-container *ngIf="cat.children && cat.children.length">
            <div class="absolute left-0 mt-2 w-40 bg-gray-800 rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10">
              <ul>
                <li *ngFor="let sub of cat.children" class="relative group">
                  <a [routerLink]="['/products']" [queryParams]="{ subcategory: sub._id }" class="hover:text-primary cursor-pointer">
                    {{ sub.name }}
                  </a>
                  <ng-container *ngIf="sub.children && sub.children.length">
                    <div class="absolute left-full top-0 ml-1 w-40 bg-gray-800 rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10">
                      <ul>
                        <li *ngFor="let subsub of sub.children">
                          <a [routerLink]="['/products']" [queryParams]="{ subcategory: subsub._id }" class="hover:text-primary cursor-pointer">
                            {{ subsub.name }}
                          </a>
                        </li>
                      </ul>
                    </div>
                  </ng-container>
                </li>
              </ul>
            </div>
          </ng-container>
        </li>
      </ng-container>
    </ul>
  </div>
  <div>
    <ul class="flex space-x-4">
      <!-- For admin, Products link goes to admin view -->
      <ng-container *ngIf="(authService.currentUser$ | async)?.role === 'admin'; else userProducts">
        <li>
          <a routerLink="/products/admin" class="hover:text-primary">Products</a>
        </li>
      </ng-container>
      <ng-template #userProducts>
        <li>
          <a routerLink="/products" class="hover:text-primary">Products</a>
        </li>
      </ng-template>
      
      <!-- Statistics available only to admin or logistics -->
      <ng-container *ngIf="(authService.currentUser$ | async)?.role === 'admin' || (authService.currentUser$ | async)?.role === 'logistics'">
        <li>
          <a routerLink="/admin" class="hover:text-primary">Statistics</a>
        </li>
      </ng-container>
      
      <ng-container *ngIf="!(authService.currentUser$ | async)">
        <li><a routerLink="/register" class="hover:text-primary">Register</a></li>
        <li><a routerLink="/login" class="hover:text-primary">Login</a></li>
      </ng-container>
      <ng-container *ngIf="authService.currentUser$ | async">
        <li><a routerLink="/cart" class="hover:text-primary">Cart</a></li>
        <li><a routerLink="/wishlist" class="hover:text-primary">Wishlist</a></li>
        <li><a routerLink="/profile" class="hover:text-primary">Profile</a></li>
        <li><a (click)="authService.logout()" routerLink="/login" class="hover:text-primary cursor-pointer">Logout</a></li>
      </ng-container>
    </ul>
  </div>
</nav>
